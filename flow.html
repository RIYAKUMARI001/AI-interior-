<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>AI Interior Design Platform - Updated Flow Diagram</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 40px 20px;
    display: flex;
    justify-content: center;
    align-items: flex-start;
  }
  .diagram-container {
    background: white;
    border-radius: 20px;
    padding: 50px 40px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    max-width: 1300px;
    width: 100%;
  }
  .diagram-title {
    text-align: center;
    font-size: 28px;
    font-weight: 700;
    color: #1a202c;
    margin-bottom: 10px;
    padding-bottom: 16px;
    position: relative;
  }
  .diagram-title::after {
    content: '';
    position: absolute;
    bottom: 0; left: 50%;
    transform: translateX(-50%);
    width: 120px; height: 4px;
    background: linear-gradient(90deg, #667eea, #764ba2);
    border-radius: 2px;
  }
  .subtitle {
    text-align: center;
    color: #64748b;
    font-size: 13px;
    margin-bottom: 40px;
  }
  .change-badge {
    display: inline-flex; align-items: center; gap: 6px;
    background: #fef3c7; border: 1px solid #f59e0b;
    color: #92400e; padding: 4px 12px; border-radius: 20px;
    font-size: 12px; font-weight: 700; margin: 2px;
  }
  .changes-row { text-align: center; margin-bottom: 30px; }
  svg { width: 100%; height: auto; display: block; }
  .footer { text-align: center; margin-top: 30px; color: #64748b; font-size: 13px; }
  .legend { display: flex; flex-wrap: wrap; gap: 16px; justify-content: center; margin-top: 24px; padding: 16px; background: #f8fafc; border-radius: 12px; }
  .legend-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: #475569; font-weight: 500; }
  .legend-dot { width: 16px; height: 16px; border-radius: 3px; flex-shrink: 0; }
</style>
</head>
<body>
<div class="diagram-container">
  <div class="diagram-title">AI Interior Design Platform ‚Äî System Flow Diagram</div>
  <div class="subtitle">Student: Riya Kumari | Roll No: 240410700017</div>

  <svg viewBox="0 0 1200 2100" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <marker id="arr" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
        <polygon points="0 0,10 3,0 6" fill="#64748b"/>
      </marker>
      <marker id="arr-yes" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
        <polygon points="0 0,10 3,0 6" fill="#10b981"/>
      </marker>
      <marker id="arr-no" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
        <polygon points="0 0,10 3,0 6" fill="#ef4444"/>
      </marker>
      <marker id="arr-orange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
        <polygon points="0 0,10 3,0 6" fill="#f59e0b"/>
      </marker>
      New: highlight glow filter for changed nodes
      <filter id="glow">
        <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
        <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
    </defs>

    <!-- ====== START ====== -->
    <rect x="425" y="20" width="350" height="75" rx="14" fill="#3b82f6" filter="drop-shadow(0 4px 8px rgba(0,0,0,0.15))"/>
    <text x="600" y="52" fill="white" font-size="16" font-weight="700" text-anchor="middle">User Opens App</text>
    <text x="600" y="72" fill="rgba(255,255,255,0.8)" font-size="11" text-anchor="middle">HomeScreen.tsx</text>

    <!-- Down -->
    <path d="M 600 95 L 600 145" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>

    <!-- ====== DECISION: Has Saved Design? ====== -->
    <path d="M 600 145 L 770 210 L 600 275 L 430 210 Z" fill="#10b981" filter="drop-shadow(0 4px 8px rgba(0,0,0,0.15))"/>
    <text x="600" y="204" fill="white" font-size="14" font-weight="700" text-anchor="middle">Has Saved</text>
    <text x="600" y="222" fill="white" font-size="14" font-weight="700" text-anchor="middle">Design?</text>

    <!-- YES ‚Üí left -->
    <path d="M 430 210 L 230 210 L 230 345" stroke="#10b981" stroke-width="2.5" fill="none" marker-end="url(#arr-yes)"/>
    <text x="320" y="198" fill="#10b981" font-size="13" font-weight="700" text-anchor="middle">YES</text>

    <!-- NO ‚Üí right -->
    <path d="M 770 210 L 970 210 L 970 345" stroke="#ef4444" stroke-width="2.5" fill="none" marker-end="url(#arr-no)"/>
    <text x="870" y="198" fill="#ef4444" font-size="13" font-weight="700" text-anchor="middle">NO</text>

    <!-- ====== LEFT: Load from MongoDB ====== (CHANGED - was AsyncStorage)
    NEW: Now shows MongoDB -->

    <!-- Updated badge -->
    <rect x="70" y="345" width="320" height="90" rx="13" fill="#059669"/>
    <rect x="110" y="348" width="80" height="16" rx="8" fill="#f59e0b"/>
    <text x="150" y="360" fill="#1a202c" font-size="9" font-weight="800" text-anchor="middle">UPDATED</text>
    <text x="230" y="376" fill="white" font-size="15" font-weight="700" text-anchor="middle">Load Design from DB</text>
    <text x="230" y="394" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">PersistenceManager.ts</text>
    <text x="230" y="410" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">MongoDB.findOne({ userId })</text>

    <!-- RIGHT: Room Setup -->
    <rect x="810" y="345" width="320" height="90" rx="13" fill="#3b82f6"/>
    <text x="970" y="376" fill="white" font-size="15" font-weight="700" text-anchor="middle">Room Setup</text>
    <text x="970" y="394" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">RoomInputScreen.tsx</text>
    <text x="970" y="410" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">Type + Dimensions (8‚Äì20ft)</text>

    <!-- Both converge -->
    <path d="M 230 435 L 230 490 L 600 490" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>
    <path d="M 970 435 L 970 490 L 600 490" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>
    <path d="M 600 490 L 600 535" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>

    <!-- ====== DECISION: Valid Input? ====== -->
    <path d="M 600 535 L 770 600 L 600 665 L 430 600 Z" fill="#10b981"/>
    <text x="600" y="594" fill="white" font-size="14" font-weight="700" text-anchor="middle">Valid Input?</text>
    <text x="600" y="612" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">8‚Äì20 ft range check</text>

    <!-- NO ‚Üí error -->
    <path d="M 770 600 L 970 600" stroke="#ef4444" stroke-width="2.5" fill="none" marker-end="url(#arr-no)"/>
    <text x="865" y="590" fill="#ef4444" font-size="13" font-weight="700" text-anchor="middle">NO</text>
    <rect x="970" y="570" width="200" height="60" rx="10" fill="#ef4444"/>
    <text x="1070" y="596" fill="white" font-size="12" font-weight="600" text-anchor="middle">Show Error Toast</text>
    <text x="1070" y="614" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">Invalid dimensions</text>

    <!-- YES ‚Üì -->
    <path d="M 600 665 L 600 730" stroke="#10b981" stroke-width="2.5" fill="none" marker-end="url(#arr-yes)"/>
    <text x="622" y="704" fill="#10b981" font-size="13" font-weight="700">YES</text>

    <!-- ====== Grid Engine ====== -->
    <rect x="430" y="730" width="340" height="85" rx="13" fill="#8b5cf6"/>
    <text x="600" y="760" fill="white" font-size="15" font-weight="700" text-anchor="middle">Grid Engine</text>
    <text x="600" y="778" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">GridEngine.ts</text>
    <text x="600" y="796" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">Create M√óN Matrix (1 cell = 1 ft)</text>

    <path d="M 600 815 L 600 860" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>

    <!-- ====== Design Editor 2D ====== -->
    <rect x="430" y="860" width="340" height="85" rx="13" fill="#3b82f6"/>
    <text x="600" y="892" fill="white" font-size="15" font-weight="700" text-anchor="middle">Design Editor (2D Canvas)</text>
    <text x="600" y="910" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">DesignEditorScreen.tsx</text>
    <text x="600" y="928" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">Grid + Furniture Sidebar</text>

    <path d="M 600 945 L 600 990" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>

    <!-- ====== DECISION: User Action? ====== -->
    <path d="M 600 990 L 780 1055 L 600 1120 L 420 1055 Z" fill="#10b981"/>
    <text x="600" y="1048" fill="white" font-size="14" font-weight="700" text-anchor="middle">User Action?</text>
    <text x="600" y="1066" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">Drag / 3D / Export</text>

    <!-- LEFT: DRAG -->
    <path d="M 420 1055 L 230 1055 L 230 1155" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>
    <text x="322" y="1044" fill="#475569" font-size="12" font-weight="700" text-anchor="middle">DRAG</text>

    <!-- RIGHT: 3D -->
    <path d="M 780 1055 L 970 1055 L 970 1155" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>
    <text x="876" y="1044" fill="#475569" font-size="12" font-weight="700" text-anchor="middle">3D VIEW</text>

    <!-- ====== Drag & Drop ====== -->
    <rect x="70" y="1155" width="320" height="85" rx="13" fill="#f59e0b"/>
    <text x="230" y="1185" fill="white" font-size="15" font-weight="700" text-anchor="middle">Drag & Drop</text>
    <text x="230" y="1203" fill="rgba(255,255,255,0.9)" font-size="11" text-anchor="middle">DragDropController.ts</text>
    <text x="230" y="1221" fill="rgba(255,255,255,0.9)" font-size="11" text-anchor="middle">PanGestureHandler</text>

    <path d="M 230 1240 L 230 1305" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>

    <!-- COLLISION CHECK -->
    <path d="M 230 1305 L 400 1370 L 230 1435 L 60 1370 Z" fill="#10b981"/>
    <text x="230" y="1364" fill="white" font-size="13" font-weight="700" text-anchor="middle">Collision?</text>
    <text x="230" y="1382" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">Snap + Check Grid</text>

    <!-- NO ‚Üí Place -->
    <path d="M 230 1435 L 230 1490" stroke="#10b981" stroke-width="2.5" fill="none" marker-end="url(#arr-yes)"/>
    <text x="252" y="1466" fill="#10b981" font-size="12" font-weight="700">NO</text>
    <rect x="70" y="1490" width="320" height="65" rx="10" fill="#059669"/>
    <text x="230" y="1518" fill="white" font-size="13" font-weight="600" text-anchor="middle">Place Furniture</text>
    <text x="230" y="1538" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">Update Zustand Store</text>

    <!-- YES ‚Üí Reject -->
    <path d="M 60 1370 L 0 1370 L 0 1510 L 60 1510" stroke="#ef4444" stroke-width="2" fill="none" marker-end="url(#arr-no)"/>
    <text x="10" y="1358" fill="#ef4444" font-size="12" font-weight="700">YES</text>
    <rect x="0" y="1590" width="160" height="55" rx="8" fill="#ef4444"/>
    <text x="80" y="1614" fill="white" font-size="12" font-weight="600" text-anchor="middle">Red Preview</text>
    <text x="80" y="1632" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">Reject Placement</text>

    <!-- Loop back from Place -->
    <path d="M 230 1555 L 230 1630 L 600 1630 L 600 1120" stroke="#64748b" stroke-width="1.5" stroke-dasharray="6" fill="none" marker-end="url(#arr)"/>
    <text x="415" y="1648" fill="#94a3b8" font-size="10" text-anchor="middle">‚Üê back to design editor</text>

    <!-- ====== Coordinate Mapper ====== -->
    <rect x="810" y="1155" width="320" height="85" rx="13" fill="#8b5cf6"/>
    <text x="970" y="1185" fill="white" font-size="15" font-weight="700" text-anchor="middle">Coordinate Mapper</text>
    <text x="970" y="1203" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">CoordMapper.ts</text>
    <text x="970" y="1221" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">2D ‚Üí 3D Transform (x,y ‚Üí x,z)</text>

    <path d="M 970 1240 L 970 1305" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>

    <!-- Three.js Renderer -->
    <rect x="810" y="1305" width="320" height="85" rx="13" fill="#3b82f6"/>
    <text x="970" y="1337" fill="white" font-size="15" font-weight="700" text-anchor="middle">Three.js Renderer</text>
    <text x="970" y="1355" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">ThreeRenderer.tsx</text>
    <text x="970" y="1373" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">expo-gl + expo-three</text>

    <path d="M 970 1390 L 970 1455" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>

    <!-- 3D View Screen -->
    <rect x="810" y="1455" width="320" height="85" rx="13" fill="#059669"/>
    <text x="970" y="1487" fill="white" font-size="15" font-weight="700" text-anchor="middle">3D View Screen</text>
    <text x="970" y="1505" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">Camera Controls</text>
    <text x="970" y="1523" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">Rotate ¬∑ Zoom ¬∑ Pan</text>

    <!-- 3D loops back -->
    <path d="M 970 1540 L 970 1630 L 600 1630" stroke="#64748b" stroke-width="1.5" stroke-dasharray="6" fill="none" marker-end="url(#arr)"/>

    <!-- ====== SAVE DECISION ====== -->
    <path d="M 600 1630 L 600 1680" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arr)"/>
    <path d="M 600 1680 L 780 1745 L 600 1810 L 420 1745 Z" fill="#10b981"/>
    <text x="600" y="1739" fill="white" font-size="14" font-weight="700" text-anchor="middle">Save Design?</text>
    <text x="600" y="1757" fill="rgba(255,255,255,0.85)" font-size="11" text-anchor="middle">User clicks Save button</text>

    <!-- YES: Save to MongoDB -->
    <path d="M 420 1745 L 240 1745" stroke="#10b981" stroke-width="2.5" fill="none" marker-end="url(#arr-yes)"/>
    <text x="330" y="1733" fill="#10b981" font-size="13" font-weight="700" text-anchor="middle">YES</text>

    <!-- ====== UPDATED: MongoDB Save ====== -->
    <rect x="50" y="1710" width="190" height="70" rx="10" fill="#059669"/>
    <rect x="50" y="1710" width="190" height="70" rx="10" fill="#059669"/>
    <rect x="52" y="1712" width="70" height="15" rx="7" fill="#f59e0b"/>
    <text x="88" y="1723" fill="#1a202c" font-size="8" font-weight="800" text-anchor="middle">UPDATED</text>
    <text x="145" y="1740" fill="white" font-size="13" font-weight="700" text-anchor="middle">Save to MongoDB</text>
    <text x="145" y="1757" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">designCollection</text>
    <text x="145" y="1772" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">.insertOne(design)</text>

    <!-- NEW: Export Decision -->
    <path d="M 145 1780 L 145 1830" stroke="#f59e0b" stroke-width="2.5" fill="none" marker-end="url(#arr-orange)"/>

    <!-- ====== NEW: Export / Download ====== -->
    <rect x="50" y="1830" width="190" height="100" rx="10" fill="#f59e0b" filter="url(#glow)"/>
    <rect x="52" y="1832" width="50" height="15" rx="7" fill="#1a202c"/>
    <text x="78" y="1843" fill="white" font-size="8" font-weight="800" text-anchor="middle">NEW</text>
    <text x="145" y="1862" fill="white" font-size="13" font-weight="700" text-anchor="middle">Export Design</text>
    <text x="145" y="1880" fill="rgba(255,255,255,0.9)" font-size="10" text-anchor="middle">ExportService.ts</text>
    <text x="145" y="1896" fill="rgba(255,255,255,0.9)" font-size="10" text-anchor="middle">üìÑ PDF Layout</text>
    <text x="145" y="1912" fill="rgba(255,255,255,0.9)" font-size="10" text-anchor="middle">üñº Screenshot (PNG)</text>

    <!-- Arrow to Download -->
    <path d="M 145 1930 L 145 1970" stroke="#f59e0b" stroke-width="2" fill="none" marker-end="url(#arr-orange)"/>

    <!-- ====== NEW: Download to Device ====== -->
    <rect x="50" y="1970" width="190" height="90" rx="10" fill="#1d4ed8"/>
    <rect x="52" y="1972" width="50" height="15" rx="7" fill="#f59e0b"/>
    <text x="78" y="1983" fill="#1a202c" font-size="8" font-weight="800" text-anchor="middle">NEW</text>
    <text x="145" y="2003" fill="white" font-size="13" font-weight="700" text-anchor="middle">Download to Device</text>
    <text x="145" y="2021" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">expo-media-library</text>
    <text x="145" y="2037" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">expo-file-system</text>
    <text x="145" y="2053" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">Saved to Gallery / Files</text>

    <!-- NEW: Offline Access -->
    <path d="M 240 2020 L 360 2020" stroke="#10b981" stroke-width="2" fill="none" marker-end="url(#arr-yes)"/>
    <rect x="360" y="1985" width="220" height="90" rx="10" fill="#0f766e"/>
    <rect x="362" y="1987" width="50" height="15" rx="7" fill="#f59e0b"/>
    <text x="388" y="1998" fill="#1a202c" font-size="8" font-weight="800" text-anchor="middle">NEW</text>
    <text x="470" y="2017" fill="white" font-size="13" font-weight="700" text-anchor="middle">Offline Access</text>
    <text x="470" y="2035" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">User opens PDF/PNG</text>
    <text x="470" y="2051" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">from device gallery</text>
    <text x="470" y="2067" fill="rgba(255,255,255,0.85)" font-size="10" text-anchor="middle">No app needed to view!</text>

    <!-- NO: Exit without saving -->
    <path d="M 780 1745 L 970 1745" stroke="#ef4444" stroke-width="2.5" fill="none" marker-end="url(#arr-no)"/>
    <text x="872" y="1733" fill="#ef4444" font-size="13" font-weight="700" text-anchor="middle">NO</text>
    <rect x="970" y="1715" width="200" height="65" rx="10" fill="#f59e0b"/>
    <text x="1070" y="1745" fill="white" font-size="13" font-weight="600" text-anchor="middle">Exit Without</text>
    <text x="1070" y="1763" fill="rgba(255,255,255,0.9)" font-size="11" text-anchor="middle">Saving</text>

    <!-- ====== END labels ====== -->
    <text x="600" y="2095" fill="#94a3b8" font-size="11" text-anchor="middle">‚Äî END OF FLOW ‚Äî</text>
  </svg>

</div>
</body>
</html>